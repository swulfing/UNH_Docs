perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
perturbation <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbation) <- ("Measure", "Sensitivity", "Elasticity")
colnames(perturbation) <- c("Measure", "Sensitivity", "Elasticity")
perturbation
perturbation$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbation
pert_sens
pert_sens <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pert_sens
sens
pert_sens <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pert_elas <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
perturbation <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbation) <- c("Measure", "Sensitivity", "Elasticity")
perturbation$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbation$Sensitivity <- c(pert_sens$stasis, pert_sens$retro, pert_sens$progr, pert_sens$fecundity, pert_sens$clonality)
perturbation$Elasticity <- c(pert_elas$stasis, pert_elas$retro, pert_elas$progr, pert_elas$fecundity, pert_elas$clonality)
pertv_sens <- perturb_vr(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pertv_sens <- perturb_vr(
matU,
matF,
matC = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda"
)
pertv_sens <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda"
)
pertv_elas <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda"
)
perturbationvr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationvr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationvr$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbationvr$Sensitivity <- c(pertv_sens$stasis, pertv_sens$retro, pertv_sens$progr, pertv_sens$fecundity, pertv_sens$clonality)
pertv_sens
pertv_sens <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda"
)
pertv_elas <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda"
)
perturbationvr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationvr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationvr$Measure <- c("Survival", "Growth", "Shrinkage", "Fecundity", "Clonality")
perturbationvr$Sensitivity <- c(pertv_sens$survival, pertv_sens$growth, pertv_sens$shrinkage, pertv_sens$fecundity, pertv_sens$clonality)
perturbationvr$Elasticity <- c(pertv_elas$survival, pertv_elas$growth, pertv_elas$shrinkage, pertv_elasvr$fecundity, pertv_elas$clonality)
pertv_sens <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda"
)
pertv_elas <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda"
)
perturbationvr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationvr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationvr$Measure <- c("Survival", "Growth", "Shrinkage", "Fecundity", "Clonality")
perturbationvr$Sensitivity <- c(pertv_sens$survival, pertv_sens$growth, pertv_sens$shrinkage, pertv_sens$fecundity, pertv_sens$clonality)
perturbationvr$Elasticity <- c(pertv_elas$survival, pertv_elas$growth, pertv_elas$shrinkage, pertv_elas$fecundity, pertv_elas$clonality)
knitr::kable(perturbationvr, format = "latex", booktabs = TRUE)
plot_life_cycle(
A,
title = NULL,
shape = "egg",
fontsize = 10,
nodefontsize = 12,
edgecol = "grey"
)
qsd_converge(mat, start = 1L, conv = 0.01, N = 100000L)
qsd_converge(A, start = 1L, conv = 0.01, N = 100000L)
senstable <- perturb_matrix(
A,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
senstable <- perturb_matrix(
A,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
senstable <- perturb_matrix(
A,
#pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
elastable <- perturb_matrix(
A,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
elastable <- perturb_matrix(
A,
#pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
pert_sens <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pert_elas <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
perturbationtr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationtr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationtr$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbationtr$Sensitivity <- c(pert_sens$stasis, pert_sens$retro, pert_sens$progr, pert_senstr$fecundity, pert_sens$clonality)
pert_sens <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pert_elas <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
perturbationtr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationtr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationtr$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbationtr$Sensitivity <- c(pert_sens$stasis, pert_sens$retro, pert_sens$progr, pert_sens$fecundity, pert_sens$clonality)
perturbationtr$Elasticity <- c(pert_elas$stasis, pert_elas$retro, pert_elas$progr, pert_elastr$fecundity, pert_elas$clonality)
pert_sens <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda",
)
pert_elas <- perturb_trans(
matU,
matR,
matC = NULL,
posU = matU > 0,
posF = matR > 0,
#posC = matC > 0,
exclude_row = NULL,
exclude_col = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda",
)
perturbationtr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationtr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationtr$Measure <- c("Stasis", "Retrogression", "Progression", "Fecundity", "Clonality")
perturbationtr$Sensitivity <- c(pert_sens$stasis, pert_sens$retro, pert_sens$progr, pert_sens$fecundity, pert_sens$clonality)
perturbationtr$Elasticity <- c(pert_elas$stasis, pert_elas$retro, pert_elas$progr, pert_elas$fecundity, pert_elas$clonality)
knitr::kable(perturbationtr, format = "latex", booktabs = TRUE)
pertv_sens <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "sensitivity",
demog_stat = "lambda"
)
pertv_elas <- perturb_vr(
matU,
matR,
matC = NULL,
pert = 1e-06,
type = "elasticity",
demog_stat = "lambda"
)
perturbationvr <- data.frame(matrix(nrow = 5, ncol = 3))
colnames(perturbationvr) <- c("Measure", "Sensitivity", "Elasticity")
perturbationvr$Measure <- c("Survival", "Growth", "Shrinkage", "Fecundity", "Clonality")
perturbationvr$Sensitivity <- c(pertv_sens$survival, pertv_sens$growth, pertv_sens$shrinkage, pertv_sens$fecundity, pertv_sens$clonality)
perturbationvr$Elasticity <- c(pertv_elas$survival, pertv_elas$growth, pertv_elas$shrinkage, pertv_elas$fecundity, pertv_elas$clonality)
knitr::kable(perturbationvr, format = "latex", booktabs = TRUE)
mature_prob(matU, matR, start = 1L)
mature_age(matU, matR, start = 1L)
mature_distrib(matU, start = 1L, c(FALSE, FALSE, FALSE, TRUE))
prob <- mature_prob(matU, matR, start = 1L)
age <- mature_age(matU, matR, start = 1L)
#mature_distrib(matU, start = 1L, c(FALSE, FALSE, FALSE, TRUE))
AgeReproTable <- data.frame(matrix(, ncol = 2, nrow = 2) )
entropytable[1] <-  c("Prob of reaching mat", "Age at Mat")
prob <- mature_prob(matU, matR, start = 1L)
age <- mature_age(matU, matR, start = 1L)
AgeReproTable <- data.frame(matrix(, ncol = 2, nrow = 2) )
entropytable[1] <-  c("Prob of reaching mat", "Age at Mat")
entropytable
prob <- mature_prob(matU, matR, start = 1L)
age <- mature_age(matU, matR, start = 1L)
#mature_distrib(matU, start = 1L, c(FALSE, FALSE, FALSE, TRUE))
AgeReproTable <- data.frame(matrix(, ncol = 2, nrow = 2) )
AgeReproTable[1] <-  c("Prob of reaching mat", "Age at Mat")
AgeReproTable[2] <- c(prob, age)
knitr::kable(AgeReproTable, format = "latex", booktabs = TRUE)
vital_rates(
matU,
matR,
matC = NULL,
weights = NULL,
splitStages = "all",
matrixStages = NULL
)
vitalrates <- data.frame(vital_rates(
matU,
matR,
matC = NULL,
weights = NULL,
splitStages = "all",
matrixStages = NULL
))
knitr::kable(vitalrates, format = "latex", booktabs = TRUE)
vr_survival(matU, posU = matU > 0, exclude_col = NULL, weights_col = NULL)
vr_growth(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vr_shrinkage(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vr_shrinkage(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vr_stasis(
matU,
posU = matU > 0,
exclude = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vrsurv <- vr_survival(matU, posU = matU > 0, exclude_col = NULL, weights_col = NULL)
vrgrow <- vr_growth(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vrshrink <- vr_shrinkage(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
vrstas <- vr_stasis(
matU,
posU = matU > 0,
exclude = NULL,
weights_col = NULL,
surv_only_na = TRUE
)
# #Not using these
# vr_dorm_enter(matU, posU = matU > 0, dorm_stages, weights_col = NULL)
# vr_dorm_exit(matU, posU = matU > 0, dorm_stages, weights_col = NULL)
VRtable <- data.frame(matrix(, ncol = 2, nrow = 4) )
VRtable[1] <-  c("Rate of Survival", "Rate of Growth", "Rate of shrinkage", "Rate of stasis")
VRtable[2] <- c(vrsurv, vrgrow, vrshrink, vrstas)
knitr::kable(VRtable, format = "latex", booktabs = TRUE)
vr_mat_U(matU, posU = matU > 0, surv_only_na = TRUE)
utable <- vr_mat_U(matU, posU = matU > 0, surv_only_na = TRUE)
knitr::kable(utable, format = "latex", booktabs = TRUE)
rtable <- vr_mat_R(matU, matR, posR = matR > 0)
knitr::kable(rtable, format = "latex", booktabs = TRUE)
stable <- vr_mat_R(matU, matR, posR = matR > 0)
vr_mat_R(matU, matR, posR = matR > 0)
vr_vec_survival(matU, posU = matU > 0, exclude_col = NULL)
vr_vec_growth(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
surv_only_na = TRUE
)
knitr::kable(stable, format = "latex", booktabs = TRUE)
vr_vec_shrinkage(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
surv_only_na = TRUE
)
vr_vec_stasis(matU, posU = matU > 0, exclude = NULL, surv_only_na = TRUE)
vr_vec_reproduction(
matU,
matR,
posR = matR > 0,
exclude_col = NULL,
weights_row = NULL
)
vrsurv <- vr_vec_survival(matU, posU = matU > 0, exclude_col = NULL)
vrgrow <- vr_vec_growth(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
surv_only_na = TRUE
)
# vr_vec_shrinkage(
# matU,
# posU = matU > 0,
# exclude = NULL,
# exclude_row = NULL,
# exclude_col = NULL,
# surv_only_na = TRUE
# )
vrstas <- vr_vec_stasis(matU, posU = matU > 0, exclude = NULL, surv_only_na = TRUE)
# vr_vec_dorm_enter(matU, posU = matU > 0, dorm_stages)
# vr_vec_dorm_exit(matU, posU = matU > 0, dorm_stages)
vrrepro <- vr_vec_reproduction(
matU,
matR,
posR = matR > 0,
exclude_col = NULL,
weights_row = NULL
)
VRtable2 <- data.frame(matrix(, ncol = 5, nrow = 5) )
colnames(VRtable2) <- c("Stage", "Survival", "Growth", "Stasis", "Reproduction")
VRtable2$Stage <- c(seq(1,4))
VRtable2 <- data.frame(matrix(, ncol = 5, nrow = 5) )
colnames(VRtable2) <- c("Stage", "Survival", "Growth", "Stasis", "Reproduction")
VRtable2
vrsurv <- vr_vec_survival(matU, posU = matU > 0, exclude_col = NULL)
vrgrow <- vr_vec_growth(
matU,
posU = matU > 0,
exclude = NULL,
exclude_row = NULL,
exclude_col = NULL,
surv_only_na = TRUE
)
# vr_vec_shrinkage(
# matU,
# posU = matU > 0,
# exclude = NULL,
# exclude_row = NULL,
# exclude_col = NULL,
# surv_only_na = TRUE
# )
vrstas <- vr_vec_stasis(matU, posU = matU > 0, exclude = NULL, surv_only_na = TRUE)
# vr_vec_dorm_enter(matU, posU = matU > 0, dorm_stages)
# vr_vec_dorm_exit(matU, posU = matU > 0, dorm_stages)
vrrepro <- vr_vec_reproduction(
matU,
matR,
posR = matR > 0,
exclude_col = NULL,
weights_row = NULL
)
VRtable2 <- data.frame(matrix(, ncol = 5, nrow = 4) )
colnames(VRtable2) <- c("Stage", "Survival", "Growth", "Stasis", "Reproduction")
VRtable2$Stage <- c(seq(1,4))
VRtable2$Survival <- c(vrsurv)
VRtable2$Growth <- c(vrgrow)
VRtable2$Stasis <- c(vrstas)
VRtable2$Reproduction <- c(vrrepro)
knitr::kable(VRtable2, format = "latex", booktabs = TRUE)
