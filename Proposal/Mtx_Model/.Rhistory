high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=.1, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=.2, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=.3, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=.5, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=.6, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=1, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=2, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=2.5, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=2.7, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=8, label="Population Increasing") +
geom_text(x=3, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=5, y=.1, label="Population Increasing") +
geom_text(x=3, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=6, y=.1, label="Population Increasing") +
geom_text(x=3, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=7, y=.07, label="Population Increasing") +
geom_text(x=3, y=.01, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=7.5, y=.07, label="Population Increasing") +
geom_text(x=3, y=.015, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=.07, label="Population Increasing") +
geom_text(x=3, y=.015, label="Population Decreasing")
#Continuous Colors
ggplot(growthRate, aes(Frequency, PercentChange, fill = lambda_new)) + geom_tile(width=1) +
scale_fill_gradient2(
low = "red",
mid = "white",
high = "green",
#limits = c(1, max(growthRate$lambda_new)),
midpoint = 1,
space = "Lab",
na.value = "grey50") +
scale_x_continuous(name = "Length of closure (months)", expand=c(0,0), breaks = c(1, 3, 6, 9, 12)) +
scale_y_continuous(name = "Percent change in survival", expand=c(0,0), labels = mult_format()) +
labs(fill = "Eigenvalue") +
geom_segment(aes(x = 2.5, y = .075, xend = 2.5, yend = 0.105), size = .5, color = "#5A5A5A") +
geom_segment(aes(x = 11.5, y = .015, xend = 12.5, yend = 0.015), size = .5, color = "#5A5A5A") +
geom_step(data = paretospagheto , aes(x=Frequency, y=PercentChange), size = .5, color = "#5A5A5A") +
geom_text(x=8, y=.07, label="Population Increasing") +
geom_text(x=3.5, y=.015, label="Population Decreasing")
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, dev="cairo_pdf")
#knitr::write_bib look into
setwd("C:/Users/sophi/Documents/GitHub/UNH_Docs/Proposal/Mtx_Model")
library(tinytex)
library(matlib)
remove.packages(htmltools)
sessionInfo()
remove.packages(‘htmltools’)
remove.packages(htmltools)
stage_break
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, dev="cairo_pdf")
#knitr::write_bib look into
setwd("C:/Users/sophi/Documents/GitHub/UNH_Docs/Proposal/Mtx_Model")
library(tinytex)
library(matlib)
library(ggplot2)
library(quadprog) #cite
library(gridtext)
library(popbio) #cite
library(knitr)
library(gridExtra)
library(RColorBrewer)
#library(rPref) #Double check what this is doing. Maybe cite?
library(tidyr)
library(dplyr)
library(ggpubr)
library(bookdown)
library(kableExtra)
library(Rage)
# #Raw data n supplemental. ASK
# in-stage bar graph goes in paper
# in stage management scenarios will definitely be supplemental
# Check out ecological modelling journal
# Write about stable stage cause I don't think you do
# Citations! Also check ahilya table
# APPENDIX!
# MAKE FIG CAPS FOR EVERYTHING AND EDIT FIGS.
observedData <- as.matrix(data.frame(read.csv("RaberinaryBenbow2012Calcs.csv")))
observedStageMatrix <- observedData[1:13, 2:5]
stage_break <- stage_break %>%
arrange(Stage)
stage_break
class(stage_break$Stage)
x
x <- c("Larval", "1", "2", "3", "4")
stage_break <- stage_break %>%
slice(match(x, Stage))
stage_break
stage_break <- data.frame(matrix(data = (c("1", "2", "3", "4", "Larval", as.numeric(rates_percent))), nrow = 5, ncol = 2))
colnames(stage_break) <- c("Stage", "Percent")
stage_break$Percent <- as.numeric(stage_break$Percent)
stage_break
x <- c("Larval", "1", "2", "3", "4")
stage_break <- stage_break %>%
slice(match(x, Stage))
colorlist <- c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000")
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
stage_break
stage_break <- stage_break %>%
slice(match(x, Stage))
colorlist <- c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000")
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
stage_break <- data.frame(matrix(data = (c("1", "2", "3", "4", "Larval", as.numeric(rates_percent))), nrow = 5, ncol = 2))
colnames(stage_break) <- c("Stage", "Percent")
stage_break$Percent <- as.numeric(stage_break$Percent)
stage_break$Stage <- factor(stage_break$Stage , levels = c("Larval", "1", "2", "3", "4"))
colorlist <- c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000")
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity")+
scale_fill_manual(values = colorlist)
colorlist <- c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000")
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity")+
scale_fill_manual(values = colorlist) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
#scale_fill_manual(values = colorlist) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
class(colorlist)
colorlist <- factor(c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000"), levels = c( "#CC79A7", "#004949", "#009292", "#db6d00", "#920000"))
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
#scale_fill_manual(values = colorlist) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity")+
#scale_fill_manual(values = colorlist) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(stage_break, aes(x = Stage, y = Percent)) +
ylab("Percent survival increase") +
geom_bar(stat="identity", fill = colorlist)+
#scale_fill_manual(values = colorlist) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
ggplot(stage_break, aes(x = Stage, y = Percent, fill = Stage)) +
ylab("Percent survival increase") +
geom_bar(stat="identity")+
scale_fill_manual(values = c("Larval" =  "#CC79A7",
"1" = "#004949",
"2" = "#009292",
"3" = "#db6d00",
"4" = "#920000")) +
theme_bw() +
theme(panel.border = element_blank(), panel.grid.major = element_blank(), panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"))
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, dev="cairo_pdf")
#knitr::write_bib look into
setwd("C:/Users/sophi/Documents/GitHub/UNH_Docs/Proposal/Mtx_Model")
library(tinytex)
library(matlib)
library(ggplot2)
library(quadprog) #cite
library(gridtext)
library(popbio) #cite
library(knitr)
library(gridExtra)
library(RColorBrewer)
#library(rPref) #Double check what this is doing. Maybe cite?
library(tidyr)
library(dplyr)
library(ggpubr)
library(bookdown)
library(kableExtra)
library(Rage)
# #Raw data n supplemental. ASK
# in-stage bar graph goes in paper
# in stage management scenarios will definitely be supplemental
# Check out ecological modelling journal
# Write about stable stage cause I don't think you do
# Citations! Also check ahilya table
# APPENDIX!
# MAKE FIG CAPS FOR EVERYTHING AND EDIT FIGS.
observedData <- as.matrix(data.frame(read.csv("RaberinaryBenbow2012Calcs.csv")))
observedStageMatrix <- observedData[1:13, 2:5]
options(tinytex.verbose = TRUE)
survivability <- function(increase){
#Calculate survivability for each staege and increase by x%
NewMtx <- (A * increase) + A
for(i in 1:ncol(NewMtx)-1){
if(sum(NewMtx[,i]) > 1 | NewMtx[4,4] > 1){
return(NA)
}}
return(NewMtx)
}
#This is stupid but it just forces R to stop writing things as complex numbers
f <- function(x) {
if (all(Im(z <- zapsmall(x))==0)) as.numeric(z) else x
}
real_check <- function(mtx){
if(sum(mtx[,1]) > 1 | sum(mtx[,2]) > 1 | sum(mtx[,3]) > 1 | mtx[4,4] > 1){
return(NA)
}
else{return(mtx)}
}
write_matex <- function(x) {
begin <- "$$\\begin{bmatrix}"
end <- "\\end{bmatrix}$$"
X <-
apply(x, 1, function(x) {
paste(
paste(x, collapse = "&"),
"\\\\"
)
})
writeLines(c(begin, X, end))
}
#Make Z
z <- matrix(t(observedStageMatrix[2:11,]), ncol = 1, nrow = 40, byrow = TRUE)
#z
#Make M
m <- matrix(, nrow = nrow(z) , ncol = 8)
for(i in 1:(nrow(observedStageMatrix)-3)){
m[(4 * (i-1) + 1):(4 * i),] <- matrix(c(observedStageMatrix[i,1], 0, 0, 0, 0, 0, observedStageMatrix[i,4], 0,
0, observedStageMatrix[i,1], observedStageMatrix[i,2], 0, 0, 0, 0, 0,
0, 0, 0, observedStageMatrix[i,2], observedStageMatrix[i,3], 0, 0, 0,
0, 0, 0, 0, 0, observedStageMatrix[i,3], 0, observedStageMatrix[i,4]),
nrow = 4, byrow = TRUE)
#m
}
#Make C
c <- matrix(c(diag(8) * (-1),
1, 1, 0, 0, 0, 0, 0, 0,
0, 0, 1, 1, 0, 0, 0, 0,
0, 0, 0, 0, 1, 1, 0, 0,
0, 0, 0, 0, 0, 0, 0, 1), nrow = 12, ncol = 8, byrow = TRUE)
#c
#Make b
b <- matrix(c(rep(0,8), rep(1,4)), nrow = 12, ncol = 1, byrow = TRUE)
#Make P
#p <- matrix(, nrow = 8, ncol = 1, byrow = TRUE) #vector(p1, g1, p2, g2, p3, g3, f4, p4)
#Make mtx G and vector x
g <- t(m) %*% m
f_t <- -(t(-z) %*% m)
qp <- solve.QP(Dmat = g, dvec = f_t, Amat = -t(c), bvec = -t(b))#, factorized = FALSE)
A <- matrix(c(qp$solution[1], 0, 0, qp$solution[7],
qp$solution[2], qp$solution[3], 0, 0,
0, qp$solution[4], qp$solution[5], 0,
0, 0, qp$solution[6], qp$solution[8]), byrow = TRUE, nrow = 4, ncol = 4)
#A
ages <- data.frame(matrix(data = NA, nrow = 4, ncol = 3))
colnames(ages) <- c("Stage", "Duration_New", "Variance")
for(i in 1:nrow(A)){
ages$Stage[i] <- i
ages$Duration_New[i] <- 1/(1-A[i,i])
ages$Variance[i] <- A[i,i]/(1-A[i,i])^2
}
knitr::kable(ages, format = "latex", booktabs = TRUE)
